___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.

___INFO___

{
  "displayName": "Cardinal Path: Dynamic GA Property ID",
  "categories": ["ANALYTICS"],
  "description": "Simplifies the ability to dyanically populate a develoment and production Google Analytics Property ID without the use of nested tables",
  "securityGroups": [],
  "id": "cvt_temp_public_id",
  "type": "MACRO",
  "version": 1,
  "containerContexts": [
    "WEB"
  ],
  "brand": {
    "displayName": "Cardinal Path",
    "id": "gtm-templates-cardinal-path",
    "thumbnail": "data:image/png;base64,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"
  }
}

___TEMPLATE_PARAMETERS___

[
  {
    "displayName": "Production UAID",
    "simpleValueType": true,
    "name": "uaid_prod",
    "type": "TEXT"
  },
  { 
    "displayName": "Development UAID",
    "simpleValueType": true,
    "name": "uaid_dev",
    "type": "TEXT"
  },
  {
    "displayName": "Debug Mode Variable",
    "simpleValueType": true,
    "name": "debugMode",
    "type": "TEXT"
  },
  {
    "displayName": "Environments Variable",
    "simpleValueType": true,
    "name": "environment",
    "type": "TEXT"
  },
  {
    "displayName": "URL Pattern for Development Domains",
    "name": "domains",
    "simpleTableColumns": [
      {
        "defaultValue": "",
        "displayName": "URL",
        "name": "url",
        "type": "TEXT"
      }
    ],
    "type": "SIMPLE_TABLE"
  }
]


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_url",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "isRequired": true
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

var logger = require('logToConsole');

const log = data.debugMode ? logger : (() => {});
const getUrl = require('getUrl');
const encodeUri = require('encodeUri');
var uaid=data.uaid_prod;
const host=getUrl('host');
//log("host:"+host);

if(data.environment.indexOf("stag")>=0||data.environment.indexOf("dev")>=0||data.environment.indexOf("draft")>=0){
  uaid=data.uaid_dev;
}

if(data.debugMode===true){
  uaid=data.uaid_dev;
}

var i;
for (i = 0; i < data.domains.length; i++) { 
  if(host.indexOf(data.domains[i].url)>=0){
    uaid=data.uaid_dev;
    break;
  }
}
return uaid;


___NOTES___

Created on 10/25/2019, 7:07:27 PM

